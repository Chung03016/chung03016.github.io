<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>修仙小助手</title>
    <link rel="stylesheet" href="css/styles.css?v=1.4.0">
    <link rel="icon" href="img/wpcp.jpg" type="image/png">
    <link rel="apple-touch-icon" href="img/wpcp.jpg">
</head>
<body>
    <div class="container">
        <button id="infoButton" class="info-btn">葵花寶典</button>
        <button id="infoButton2" class="info-btn2">小工具</button>
        <div id="infoModal" class="modal">
            <div class="modal-content">
                <span class="close">&times;</span>
                <div class="tabs">
                <button class="tab-btn-q active" data-target="tab-qa-table">問答</button>
                <button class="tab-btn-q" data-target="tab-qa-info-1">功/法寶</button>
                <button class="tab-btn-q" data-target="tab-qa-info-3">打帖戰力</button>
                <button class="tab-btn-q" data-target="tab-qa-info-2">妖靈塔</button>
                </div>
                <div class="tab-content-q" id="tab-qa-table" style="display:block;">
                    <h2 style="color:#666;">問答題選擇與獎勵對應表</h2>
                    <div class="modal-body">
                        <table class="modal-table">
                            <tbody>
                                <tr><td>幫助鸞鳥</td><td style="color:rgb(17, 144, 66);">聚靈丹</td><td>幫助金鼠</td><td  style="color:rgb(255, 149, 0);">元氣丹</td></tr>
                                <tr style="background-color: rgba(213, 213, 213, 0.33);"><td>贈藥</td><td style="color:rgb(17, 144, 66);">聚靈丹</td><td>救治</td><td  style="color:rgb(255, 149, 0);">元氣丹</td></tr>
                                <tr><td>與其戰鬥</td><td style="color:rgb(17, 144, 66);">聚靈丹</td><td>好言相勸</td><td style="color:rgb(218, 2, 2);">扣修為</td></tr>
                                <tr style="background-color: rgba(213, 213, 213, 0.33);"><td>救治</td><td style="color:rgb(17, 144, 66);">聚靈丹</td><td>離去</td><td style="color:rgb(218, 2, 2);">扣修為</td></tr>
                                <tr><td>乘船前往</td><td style="color:rgb(17, 144, 66);">聚靈丹</td><td>御劍前往</td><td style="color:rgb(182, 70, 0);">挑戰帖</td></tr>
                                <tr style="background-color: rgba(213, 213, 213, 0.33);"><td>黑水湖</td><td style="color:rgb(218, 2, 2);">扣修為</td><td>花蓮村</td><td style="color:rgb(17, 144, 66);">聚靈丹</td></tr>
                                <tr><td>澆灌藥園</td><td>加修為</td><td>煉丹</td><td style="color:rgb(17, 144, 66);">聚靈丹</td></tr>
                                <tr style="background-color: rgba(213, 213, 213, 0.33);"><td>仙草</td><td>加修為</td><td>丹藥</td><td style="color:rgb(17, 144, 66);">聚靈丹</td></tr>
                                <tr><td>夜晚前往</td><td  style="color:rgb(255, 149, 0);">元氣丹</td><td>白天前往</td><td>無</td></tr>
                                <tr style="background-color: rgba(213, 213, 213, 0.33);"><td>一同探索</td><td style="color:rgb(218, 2, 2);">扣修為</td><td>分開探索</td><td  style="color:rgb(255, 149, 0);">元氣丹</td></tr>
                                <tr><td>向左走</td><td style="color:rgb(218, 2, 2);">扣修為</td><td>向右走</td><td style="color:rgb(182, 70, 0);">挑戰帖</td></tr>
                                <tr style="background-color: rgba(213, 213, 213, 0.33);"><td>暗中調查</td><td style="color:rgb(182, 70, 0);">挑戰帖</td><td>正面出擊</td><td>無</td></tr>
                                <tr><td>與其戰鬥</td><td style="color:rgb(182, 70, 0);">挑戰帖</td><td>表達敬仰</td><td>加修為</td></tr>
                                <tr style="background-color: rgba(213, 213, 213, 0.33);"><td>善良</td><td style="color:rgb(218, 2, 2);">扣修為</td><td>強大</td><td style="color:rgb(182, 70, 0);">挑戰帖</td></tr>
                                <tr><td>勇敢靠近</td><td>加修為</td><td>迅速躲避</td><td>無</td></tr>
                                <tr style="background-color: rgba(213, 213, 213, 0.33);"><td>上前切磋</td><td>加修為</td><td>謙虛回絕</td><td>無</td></tr>
                                <tr><td>淺處挖掘</td><td>加修為</td><td>深處挖掘</td><td>無</td></tr>
                                <tr style="background-color: rgba(213, 213, 213, 0.33);"><td>普通的靈石</td><td>加修為</td><td>古怪的靈石</td><td>加修為(較多)</td></tr>
                                <tr><td>食用果實</td><td>加修為(較多)</td><td>飲用溪水</td><td>加修為</td></tr>
                                <tr style="background-color: rgba(213, 213, 213, 0.33);"><td>過去</td><td style="color:rgb(17, 144, 66);">聚靈丹</td><td>未來</td><td style="color:rgb(218, 2, 2);">扣修為</td></tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                <div class="tab-content-q" id="tab-qa-info-1" style="display:none;">
                    <h2 style="color:#666;">功法/法寶保底</h2>
                    <div class="modal-body">
                        <table class="modal-table">
                            <thead>
                                <tr style="background-color: rgba(213, 213, 213, 0.33);">
                                    <th>階段</th>
                                    <th>功法</th>
                                    <th>法寶</th>
                                    <th>保底</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>Lv.1 凡人</td>
                                    <td>戰力+100</td>
                                    <td>戰力+180</td>
                                    <td>5</td>
                                </tr>
                                <tr style="background-color: rgba(213, 213, 213, 0.33);">
                                    <td>Lv.2 練氣</td>
                                    <td>戰力+400</td>
                                    <td>戰力+430</td>
                                    <td>10</td>
                                </tr>
                                <tr>
                                    <td>Lv.3 築基</td>
                                    <td>戰力+7000</td>
                                    <td>戰力+7000</td>
                                    <td>20</td>
                                </tr>
                                <tr style="background-color: rgba(213, 213, 213, 0.33);">
                                    <td>Lv.4 結丹</td>
                                    <td style="background-color: rgba(253,255,124,0.47);">修煉速度+5%</td>
                                    <td>戰力+2萬<span style="color:rgb(218, 2, 2);"><br>(禮包)</span></td>
                                    <td>40</td>
                                </tr>
                                <tr>
                                    <td>Lv.5 元嬰</td>
                                    <td style="background-color: rgba(253,255,124,0.47);">修煉速度+5%</td>
                                    <td>戰力+6萬</td>
                                    <td>60</td>
                                </tr>
                                <tr style="background-color: rgba(213, 213, 213, 0.33);">
                                    <td>Lv.6 出竅</td>
                                    <td>火屬戰力+3%</td>
                                    <td>戰力+8萬</td>
                                    <td>80</td>
                                </tr>
                                <tr>
                                    <td>Lv.7 化神</td>
                                    <td style="background-color: rgba(253,255,124,0.47);">水屬戰力+3%</td>
                                    <td>戰力+10萬</td>
                                    <td>100</td>
                                </tr>
                                <tr style="background-color: rgba(213, 213, 213, 0.33);">
                                    <td>Lv.8 合體</td>
                                    <td>木屬戰力+3%</td>
                                    <td>戰力+14萬</td>
                                    <td>120</td>
                                </tr>
                                <tr>
                                    <td>Lv.9 洞虛</td>
                                    <td>戰力+10萬</td>
                                    <td>戰力+20萬</td>
                                    <td>150</td>
                                </tr>
                                <tr style="background-color: rgba(213, 213, 213, 0.33);">
                                    <td>Lv.10 大承</td>
                                    <td>戰力+1%</td>
                                    <td>戰力+40萬</td>
                                    <td>180</td>
                                </tr>
                                <tr>
                                    <td>Lv.11 渡劫</td>
                                    <td style="background-color: rgba(253,255,124,0.47);">修煉速度+15%</td>
                                    <td>戰力+1%</td>
                                    <td>210</td>
                                </tr>
                                <tr style="background-color: rgba(213, 213, 213, 0.33);">
                                    <td>Lv.12 人仙</td>
                                    <td>修煉速度+30%<span style="color:rgb(218, 2, 2);"><br>(禮包)</span></td>
                                    <td>戰力+100萬</td>
                                    <td>250</td>
                                </tr>
                                <tr>
                                    <td>Lv.13 真仙</td>
                                    <td>木屬戰力+5%</td>
                                    <td>戰力+130萬</td>
                                    <td>290</td>
                                </tr>
                                <tr style="background-color: rgba(213, 213, 213, 0.33);">
                                    <td>Lv.14 金仙</td>
                                    <td>火屬戰力+5%</td>
                                    <td>戰力+170萬</td>
                                    <td>330</td>
                                </tr>
                                <tr>
                                    <td>Lv.15 上仙</td>
                                    <td>水屬戰力+5%<span style="color:rgb(218, 2, 2);"><br>(禮包)</span></td>
                                    <td>戰力+5%<span style="color:rgb(218, 2, 2);"><br>(禮包)</span></td>
                                    <td>370</td>
                                </tr>
                                <tr style="background-color: rgba(213, 213, 213, 0.33);">
                                    <td>Lv.16 仙君</td>
                                    <td>戰力+300萬</td>
                                    <td>戰力+300萬</td>
                                    <td>410</td>
                                </tr>
                                <tr>
                                    <td>Lv.17 仙尊</td>
                                    <td>戰力+5%</td>
                                    <td>戰力+350萬</td>
                                    <td>450</td>
                                </tr>
                                <tr style="background-color: rgba(213, 213, 213, 0.33);">
                                    <td>Lv.18 仙帝</td>
                                    <td>修煉速度+70%</td>
                                    <td>戰力+15%</td>
                                    <td>500</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                <div class="tab-content-q" id="tab-qa-info-2" style="display:none;">
                    <h2  style="color:#666;">妖靈塔保底</h2>
                    <div class="modal-body">
                        <table class="modal-table">
                            <thead>
                                <tr style="background-color: rgba(213, 213, 213, 0.33);">
                                    <th>階段</th>
                                    <th>等級</th>
                                    <th>機率</th>
                                    <th>保底</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>Lv.1 - Lv.4</td>
                                    <td>一級喚妖鈴</td>
                                    <td>3%</td>
                                    <td>20 (1萬金幣)</td>
                                </tr>
                                <tr style="background-color: rgba(213, 213, 213, 0.33);">
                                    <td>Lv.5 - Lv.9</td>
                                    <td style="line-height:1.2;">一級喚妖鈴<hr style="margin:5px 0px; border: none; height: 1px; background-color:rgba(195, 195, 195, 0.71);">二級喚妖鈴</td>
                                    <td>3%<hr style="margin:5px 0px; border: none; height: 1px; background-color:rgba(195, 195, 195, 0.71);">0.95%</td>
                                    <td>20 (1萬金幣)<hr style="margin:5px 0px; border: none; height: 1px; background-color:rgba(195, 195, 195, 0.71);">60 (3萬金幣)</td>
                                </tr>
                                <tr>
                                    <td>Lv.10 - Lv.13</td>
                                    <td>二級喚妖鈴<hr style="margin:5px 0px; border: none; height: 1px; background-color:rgba(195, 195, 195, 0.71);">三級喚妖鈴</td>
                                    <td>0.95%<hr style="margin:5px 0px; border: none; height: 1px; background-color:rgba(195, 195, 195, 0.71);">0.28%</td>
                                    <td>60 (3萬金幣)<hr style="margin:5px 0px; border: none; height: 1px; background-color:rgba(195, 195, 195, 0.71);">200 (10萬金幣)</td>
                                </tr>
                                <tr style="background-color: rgba(213, 213, 213, 0.33);">
                                    <td>Lv.14 - Lv.18</td>
                                    <td>三級喚妖鈴<hr style="margin:5px 0px; border: none; height: 1px; background-color:rgba(195, 195, 195, 0.71);">四級喚妖鈴</td>
                                    <td>0.28%<hr style="margin:5px 0px; border: none; height: 1px; background-color:rgba(195, 195, 195, 0.71);">0.13%</td>
                                    <td>200 (10萬金幣)<hr style="margin:5px 0px; border: none; height: 1px; background-color:rgba(195, 195, 195, 0.71);">400 (20萬金幣)</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                <div class="tab-content-q" id="tab-qa-info-3" style="display:none;">
                    <h2  style="color:#666;">打帖戰力增加</h2>
                    <div class="modal-body">
                        <table class="modal-table">
                            <thead>
                                <tr style="background-color: rgba(213, 213, 213, 0.33);">
                                    <th>階段</th>
                                    <th>挑戰增加的戰力</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>Lv.1 凡人</td>
                                    <td>戰力+20</td>
                                </tr>
                                <tr style="background-color: rgba(213, 213, 213, 0.33);">
                                    <td>Lv.2 練氣</td>
                                    <td>戰力+100</td>
                                </tr>
                                <tr>
                                    <td>Lv.3 築基</td>
                                    <td>戰力+800</td>
                                </tr>
                                <tr style="background-color: rgba(213, 213, 213, 0.33);">
                                    <td>Lv.4 結丹</td>
                                    <td>戰力+1,000</td>
                                </tr>
                                <tr>
                                    <td>Lv.5 元嬰</td>
                                    <td>戰力+1,500</td>
                                </tr>
                                <tr style="background-color: rgba(213, 213, 213, 0.33);">
                                    <td>Lv.6 出竅</td>
                                    <td>戰力+2,000</td>
                                </tr>
                                <tr>
                                    <td>Lv.7 化神</td>
                                    <td>戰力+3,000</td>
                                </tr>
                                <tr style="background-color: rgba(213, 213, 213, 0.33);">
                                    <td>Lv.8 合體</td>
                                    <td>戰力+4,000</td>
                                </tr>
                                <tr>
                                    <td>Lv.9 洞虛</td>
                                    <td>戰力+5,000</td>
                                </tr>
                                <tr style="background-color: rgba(213, 213, 213, 0.33);">
                                    <td>Lv.10 大承</td>
                                    <td>戰力+6,000</td>
                                </tr>
                                <tr>
                                    <td>Lv.11 渡劫</td>
                                    <td>戰力+8,000</td>
                                </tr>
                                <tr style="background-color: rgba(252, 254, 143, 0.47);">
                                    <td>Lv.12 人仙</td>
                                    <td>戰力+20,000</td>
                                </tr>
                                <tr  style="background-color: rgba(254, 255, 196, 0.47);">
                                    <td>Lv.13 真仙</td>
                                    <td>戰力+25,000</td>
                                </tr>
                                <tr style="background-color: rgba(252, 254, 143, 0.47);">
                                    <td>Lv.14 金仙</td>
                                    <td>戰力+28,000</td>
                                </tr>
                                <tr style="background-color: rgba(254, 255, 196, 0.47);">
                                    <td>Lv.15 上仙</td>
                                    <td>戰力+30,000</td>
                                </tr>
                                <tr style="background-color: rgba(252, 254, 143, 0.47);">
                                    <td>Lv.16 仙君</td>
                                    <td>戰力+45,000</td>
                                </tr>
                                <tr style="background-color: rgba(254, 255, 196, 0.47);">
                                    <td>Lv.17 仙尊</td>
                                    <td>戰力+60,000</td>
                                </tr>
                                <tr style="background-color: rgba(252, 254, 143, 0.47);">
                                    <td>Lv.18 仙帝</td>
                                    <td>戰力+100,000</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
        <div id="infoModal2" class="modal">
            <div class="modal-content">
                <span class="close2">&times;</span>
                <div class="tabs">
                    <button class="tab-btn active" data-target="tab-training">修練時間計算</button>
                    <button class="tab-btn" data-target="tab-linroom">靈泉房計算</button>
                    <button class="tab-btn" data-target="tab-storage">結晶儲存計算</button>
                </div>
                <div class="tab-content" id="tab-training" style="display: block;">
                    <h3 style="color:#444;">修練時間計算</h3>
                    <label>現在等級：</label>
                    <select id="now-lv" onchange="processTrainingTime()">
                        <option value="42550">Lv.3 築基前期</option>
                        <option value="37150">Lv.3 築基中期</option>
                        <option value="24150">Lv.3 築基後期</option>
                        <option value="95625">Lv.4 結丹前期</option>
                        <option value="70625">Lv.4 結丹中期</option>
                        <option value="44625">Lv.4 結丹後期</option>
                        <option value="154980">Lv.5 元嬰前期</option>
                        <option value="106155">Lv.5 元嬰中期</option>
                        <option value="54915">Lv.5 元嬰後期</option>
                        <option value="177765">Lv.6 出竅前期</option>
                        <option value="121275">Lv.6 出竅中期</option>
                        <option value="61950">Lv.6 出竅後期</option>
                        <option value="206220">Lv.7 化神前期</option>
                        <option value="140805">Lv.7 化神中期</option>
                        <option value="72135">Lv.7 化神後期</option>
                        <option value="322140">Lv.8 合體前期</option>
                        <option value="246435">Lv.8 合體中期</option>
                        <option value="166950">Lv.8 合體後期</option>
                        <option value="552320">Lv.9 洞虛前期</option>
                        <option value="376970">Lv.9 洞虛中期</option>
                        <option value="193200">Lv.9 洞虛後期</option>
                        <option value="639765">Lv.10 大乘前期</option>
                        <option value="436800">Lv.10 大乘中期</option>
                        <option value="223650">Lv.10 大乘後期</option>
                        <option value="861000">Lv.11 渡劫前期</option>
                        <option value="598500">Lv.11 渡劫中期</option>
                        <option value="315000">Lv.11 渡劫後期</option>
                        <option value="2841000">Lv.12 人仙前期</option>
                        <option value="1764000">Lv.12 人仙中期</option>
                        <option value="903000">Lv.12 人仙後期</option>
                        <option value="2818895">Lv.13 真仙前期</option>
                        <option value="1895985">Lv.13 真仙中期</option>
                        <option value="950985">Lv.13 真仙後期</option>
                        <option value="2956905">Lv.14 金仙前期</option>
                        <option value="1988805">Lv.14 金仙中期</option>
                        <option value="1003275">Lv.14 金仙後期</option>
                        <option value="3117942">Lv.15 上仙前期</option>
                        <option value="2097922">Lv.15 上仙中期</option>
                        <option value="1058422">Lv.15 上仙後期</option>
                        <option value="6352500">Lv.16 仙君前期</option>
                        <option value="3832500">Lv.16 仙君中期</option>
                        <option value="1942500">Lv.16 仙君後期</option>
                        <option value="6777750">Lv.17 仙尊前期</option>
                        <option value="4730250">Lv.17 仙尊中期</option>
                        <option value="2478000">Lv.17 仙尊後期</option>
                    </select><br><br>
                    <input type="number" id="now-exp" placeholder="請輸入當前修為" oninput="processTrainingTime()"><br><br>
                    <input type="number" id="c-speed" placeholder="目前修練速度" oninput="processTrainingTime()"><br><br>
                    <input type="number" id="energy-pill" placeholder="吃元氣丹可補回經驗" oninput="processTrainingTime()"><br><br>
                    <p style="color:#333; font-size:16px;">離晉升還需要的時間</p>
                    <div class="result" style="color:#f00; " id="trainingTime">-</div>
                    <div id="pkTime" style="color:#6d6d6d; "></div> 
                    <p style="color:#333;font-size:16px;">預計晉升時間</p>
                    <div>
                        <span class="result" style="color:#f00; margin-bottom:20px;" id="expectedTime">-</span>
                        <span class="result" style="color:#f00;" id="nextPromotionSlot">-</span>
                    </div>
                </div>
                <div class="tab-content" id="tab-linroom" style="display: none;">
                    <h3 style="color:#444;">靈泉房計算</h3>
                    <input type="number" id="linroom" placeholder="請輸入報名房間數" oninput="processLinRoom()"><br><br>
                    <p style="color:#333;">最終靈泉房數量</p>
                    <div class="result" style="color:#f00;" id="linroomans">-</div>
                    <p style="color:#333;">有機會輪空的輪次</p>
                    <div class="result" style="color:#f00; margin-bottom:20px;" id="linroompass">-</div>
                </div>
                <div class="tab-content" id="tab-storage" style="display: none;">
                    <h3 style="color:#444;">結晶儲存計算</h3>
                    <label>現在等級：</label>
                    <select id="S-now-lv" onchange="processStorageTime()">
                        <option value="5400">Lv.3 築基前期</option>
                        <option value="13000">Lv.3 築基中期</option>
                        <option value="24150">Lv.3 築基後期</option>
                        <option value="25000">Lv.4 結丹前期</option>
                        <option value="26000">Lv.4 結丹中期</option>
                        <option value="44625">Lv.4 結丹後期</option>
                        <option value="48825">Lv.5 元嬰前期</option>
                        <option value="51240">Lv.5 元嬰中期</option>
                        <option value="54915">Lv.5 元嬰後期</option>
                        <option value="56490">Lv.6 出竅前期</option>
                        <option value="59325">Lv.6 出竅中期</option>
                        <option value="61950">Lv.6 出竅後期</option>
                        <option value="65415">Lv.7 化神前期</option>
                        <option value="68670">Lv.7 化神中期</option>
                        <option value="72135">Lv.7 化神後期</option>
                        <option value="75705">Lv.8 合體前期</option>
                        <option value="79485">Lv.8 合體中期</option>
                        <option value="166950">Lv.8 合體後期</option>
                        <option value="175350">Lv.9 洞虛前期</option>
                        <option value="183750">Lv.9 洞虛中期</option>
                        <option value="193200">Lv.9 洞虛後期</option>
                        <option value="202965">Lv.10 大乘前期</option>
                        <option value="213150">Lv.10 大乘中期</option>
                        <option value="223650">Lv.10 大乘後期</option>
                        <option value="262500">Lv.11 渡劫前期</option>
                        <option value="283500">Lv.11 渡劫中期</option>
                        <option value="315000">Lv.11 渡劫後期</option>
                        <option value="1050000">Lv.12 人仙前期</option>
                        <option value="861000">Lv.12 人仙中期</option>
                        <option value="903000">Lv.12 人仙後期</option>
                        <option value="924000">Lv.13 真仙前期</option>
                        <option value="945000">Lv.13 真仙中期</option>
                        <option value="950985">Lv.13 真仙後期</option>
                        <option value="966980">Lv.14 金仙前期</option>
                        <option value="985530">Lv.14 金仙中期</option>
                        <option value="1003275">Lv.14 金仙後期</option>
                        <option value="1020000">Lv.15 上仙前期</option>
                        <option value="1039500">Lv.15 上仙中期</option>
                        <option value="1058422">Lv.15 上仙後期</option>
                        <option value="2520000">Lv.16 仙君前期</option>
                        <option value="1890000">Lv.16 仙君中期</option>
                        <option value="1942500">Lv.16 仙君後期</option>
                        <option value="2047500">Lv.17 仙尊前期</option>
                        <option value="2252250">Lv.17 仙尊中期</option>
                        <option value="2478000">Lv.17 仙尊後期</option>
                    </select><br><br>
                    <input type="number" id="S-c-speed" placeholder="目前修練速度" oninput="processStorageTime()"><br><br>
                    <p style="color:#333; font-size:16px;">收取結晶時間</p>
                    <div class="result" style="color:#f00; " id="StorageTime">-</div>
                </div>
            </div>
        </div>
        <h1>修仙小助手</h1>
        <div class="vertical-card-carousel">
            <div class="carousel-card-display" id="verticalCardDisplay">

            </div>
            <div id="infoNotice" style="text-align:center;">
                <span id="infoText" style="color:#FFD306;"></span>
            </div>
            <div class="btn-group-full">
                <button class="marquee-btn" id="openRequestModal">求打</button>
                <button class="marquee-btn" id="openAllRequestsModal">展開</button>
            </div>

            <div id="allRequestsModal" class="request-modal">
            <div class="request2-modal-content" style="max-height: 80vh; overflow-y: auto;">
                <span class="closeAllRequestsModal">&times;</span>
                <h2>全部求打資訊</h2>
                <select id="searchLevel" style="margin-bottom: 16px; padding: 8px 12px; border-radius: 6px;">
                    <option value="">🔍 選擇等級（全部）</option>
                    <option value="1">Lv.1 凡人</option>
                    <option value="2">Lv.2 練氣</option>
                    <option value="3">Lv.3 築基</option>
                    <option value="4">Lv.4 結丹</option>
                    <option value="5">Lv.5 元嬰</option>
                    <option value="6">Lv.6 出竅</option>
                    <option value="7">Lv.7 化神</option>
                    <option value="8">Lv.8 合體</option>
                    <option value="9">Lv.9 洞虛</option>
                    <option value="10">Lv.10 大承</option>
                    <option value="11">Lv.11 渡劫</option>
                    <option value="12">Lv.12 人仙</option>
                    <option value="13">Lv.13 真仙</option>
                    <option value="14">Lv.14 金仙</option>
                    <option value="15">Lv.15 上仙</option>
                    <option value="16">Lv.16 仙君</option>
                    <option value="17">Lv.17 仙尊</option>
                    <option value="18">Lv.18 仙帝</option>
                </select>
                <div id="allRequestsList" class="all-request-cards .carousel-card"></div>
            </div>
            </div>
        </div>


        <div class="section">
            <h2>您的戰力</h2>
            <input type="number" id="inputValue" placeholder="請輸入您的戰力" oninput="updateCalculations()">
            <div class="section-2">
                <h3>功法</h3>
                <div class="gongfa-grid">
                    <label><input type="checkbox" class="gongfa" value="火-3">天元神火訣(Lv6)</label>
                    <label><input type="checkbox" class="gongfa" value="水-3">潤下之水法(Lv7)</label>
                    <label><input type="checkbox" class="gongfa" value="木-3">木日曲直卷(Lv8)</label>
                    <label><input type="checkbox" class="gongfa" value="木-5">春木衍光符(Lv13)</label>
                    <label><input type="checkbox" class="gongfa" value="火-5">火燚聖火功(Lv14)</label>
                    <label><input type="checkbox" class="gongfa" value="水-5">萬世橫江典(Lv15)</label>
                </div>
            </div>
            <h3>您的心法配置</h3>
            <select class="skill-select" id="config1" onchange="updateConfig(0, this.value)"></select>
            <select class="skill-select" id="config2" onchange="updateConfig(1, this.value)"></select>
            <select class="skill-select" id="config3" onchange="updateConfig(2, this.value)"></select>
            <select class="skill-select" id="config4" onchange="updateConfig(3, this.value)"></select>
            <div class="config-grid">
                <div class="config-box" id="box1"></div>
                <div class="config-box" id="box2"></div>
                <div class="config-box" id="box3"></div>
                <div class="config-box" id="box4"></div>
            </div>
            <p>💧可攻擊的最大戰力</p>
            <div class="result" id="waterResult">-</div>
            <p>🔥可攻擊的最大戰力</p>
            <div class="result" id="fireResult">-</div>
            <p>🪵可攻擊的最大戰力</p>
            <div class="result" id="woodResult">-</div>
        </div>
        <div class="section">
            <h2>對手戰力</h2>
            <input type="number" id="opponentPower" placeholder="請輸入對手戰力" oninput="updateCalculations()">
            <div class="section-2">
                <h3>功法</h3>
                <div class="gongfa-grid">
                    <label><input type="checkbox" class="opponent-gongfa" value="火-3">天元神火訣(Lv6)</label>
                    <label><input type="checkbox" class="opponent-gongfa" value="水-3">潤下之水法(Lv7)</label>
                    <label><input type="checkbox" class="opponent-gongfa" value="木-3">木日曲直卷(Lv8)</label>
                    <label><input type="checkbox" class="opponent-gongfa" value="木-5">春木衍光符(Lv13)</label>
                    <label><input type="checkbox" class="opponent-gongfa" value="火-5">火燚聖火功(Lv14)</label>
                    <label><input type="checkbox" class="opponent-gongfa" value="水-5">萬世橫江典(Lv15)</label>
                </div>
            </div>
            <h3>對手的心法配置</h3>
            <select class="skill-select" id="opponentConfig1" onchange="updateConfig(4, this.value)"></select>
            <select class="skill-select" id="opponentConfig2" onchange="updateConfig(5, this.value)"></select>
            <select class="skill-select" id="opponentConfig3" onchange="updateConfig(6, this.value)"></select>
            <select class="skill-select" id="opponentConfig4" onchange="updateConfig(7, this.value)"></select>
            <div class="config-grid">
                <div class="config-box" id="box5"></div>
                <div class="config-box" id="box6"></div>
                <div class="config-box" id="box7"></div>
                <div class="config-box" id="box8"></div>
            </div>
            <p>💧至少需要的戰力</p>
            <div class="result" id="requiredWaterPower">-</div>
            <p>🔥至少需要的戰力</p>
            <div class="result" id="requiredFirePower">-</div>
            <p>🪵至少需要的戰力</p>
            <div class="result" id="requiredWoodPower">-</div>
        </div>
        <div id="visitCounter" style="color:#fff; font-size:14px; margin-top:20px;"></div>
        <footer>© 2025 ᴍᴀʀᴄᴏ . All rights reserved.</footer>
    </div>
    <div id="updateNoticeModal" class="update-modal">
        <div class="update-modal-content">
            <span class="update-close">&times;</span>
            <div class="update-header">
                <h2>🔔 更新公告 🔔</h2>
                <p class="update-date">2025 / 05 / 04</p>
            </div>
            <div class="update-body">
                <p class="indented-bullet">
                    <span class="bullet-icon">➠</span>
                    新增修練等級預測器(右小角懸浮按鈕)，可根據目前的狀況去預測本紀元可能達到的階段。
                </p>
            </div>
            <div class="update-footer">
                <button id="dismissForeverBtn" class="danger">不再顯示此公告</button>
            </div>
        </div>
    </div>
    <a href="#" id="floatingBtn">
        <img src="img/wpcp_btn3.png" alt="建議" class="floating-image-button">
    </a>

    <div id="feedbackModal" class="request-modal">
        <div class="request-modal-content">
            <span class="closeFeedbackModal">&times;</span>
            <h2>使用者反饋</h2>
            <form id="feedbackForm">
                <input type="text" id="fb-nickname" placeholder="暱稱">
                <input type="text" id="fb-id" placeholder="您的ID(請正確填寫我才有辦法聯繫您)">
                <textarea id="fb-message" placeholder="請輸入您的問題或建議，如果想要感謝我也可以留言呦！" rows="4" style="resize: none;"></textarea>
                <button type="button" id="submitFeedback">送出</button>
            </form>
        </div>
    </div>
    <div id="requestModal" class="request-modal">
        <div class="request-modal-content">
            <span class="closeRequestModal">&times;</span>
            <h2>求打資訊填寫</h2>
            <form id="requestForm">
                <select id="req-level">
                    <option value="">您的等級</option>
                    <option value="1">Lv.1 凡人</option>
                    <option value="2">Lv.2 練氣</option>
                    <option value="3">Lv.3 築基</option>
                    <option value="4">Lv.4 結丹</option>
                    <option value="5">Lv.5 元嬰</option>
                    <option value="6">Lv.6 出竅</option>
                    <option value="7">Lv.7 化神</option>
                    <option value="8">Lv.8 合體</option>
                    <option value="9">Lv.9 洞虛</option>
                    <option value="10">Lv.10 大承</option>
                    <option value="11">Lv.11 渡劫</option>
                    <option value="12">Lv.12 人仙</option>
                    <option value="13">Lv.13 真仙</option>
                    <option value="14">Lv.14 金仙</option>
                    <option value="15">Lv.15 上仙</option>
                    <option value="16">Lv.16 仙君</option>
                    <option value="17">Lv.17 仙尊</option>
                    <option value="18">Lv.18 仙帝</option>
                </select>
                <input type="text" id="req-nickname" placeholder="請輸入遊戲暱稱" >
                <input type="number" id="req-power" placeholder="請輸入目前戰力">
                <select id="req-attr">
                    <option value="">請選擇求打屬性</option>
                    <option value="水">水屬</option>
                    <option value="火">火屬</option>
                    <option value="木">木屬</option>
                </select>
                <input type="text" id="req-location" placeholder="請輸入求打位置">
                <input type="text" id="req-note" placeholder="備註">

                <div></div>
                <button type="button" id="submitRequest">發送</button>
            </form>

        </div>
    </div>

    <a href="#" id="floatingPredictBtn">
        <img src="img/wpcp_btn4.png" alt="修練預測" class="floating-image-button" style="bottom: 110px; width:75px; height:75px;right:25px;">
    </a>
    <div id="predictModal" class="modal">
        <div class="modal-content" style="max-height: 90vh; overflow-y: auto; padding: 20px;">
            <span class="closePredictModal" style="float:right; cursor:pointer;">&times;</span>
            <div id="predictorContent">
                <div style="padding:20px;max-width:600px;margin:auto">
                    <h2 style="color:#333;">🔮 修練預測器</h2>

                    <select id="currentStage">
                    <option>選取您目前的階段</option>
                    <option>Lv.1 凡人前期</option><option>Lv.1 凡人中期</option><option>Lv.1 凡人後期</option>
                    <option>Lv.2 煉氣前期</option><option>Lv.2 煉氣中期</option><option>Lv.2 煉氣後期</option>
                    <option>Lv.3 築基前期</option><option>Lv.3 築基中期</option><option>Lv.3 築基後期</option>
                    <option>Lv.4 結丹前期</option><option>Lv.4 結丹中期</option><option>Lv.4 結丹後期</option>
                    <option>Lv.5 元嬰前期</option><option>Lv.5 元嬰中期</option><option>Lv.5 元嬰後期</option>
                    <option>Lv.6 出竅前期</option><option>Lv.6 出竅中期</option><option>Lv.6 出竅後期</option>
                    <option>Lv.7 化神前期</option><option>Lv.7 化神中期</option><option>Lv.7 化神後期</option>
                    <option>Lv.8 合體前期</option><option>Lv.8 合體中期</option><option>Lv.8 合體後期</option>
                    <option>Lv.9 洞虛前期</option><option>Lv.9 洞虛中期</option><option>Lv.9 洞虛後期</option>
                    <option>Lv.10 大承前期</option><option>Lv.10 大承中期</option><option>Lv.10 大承後期</option>
                    <option>Lv.11 渡劫前期</option><option>Lv.11 渡劫中期</option><option>Lv.11 渡劫後期</option>
                    <option>Lv.12 人仙前期</option><option>Lv.12 人仙中期</option><option>Lv.12 人仙後期</option>
                    <option>Lv.13 真仙前期</option><option>Lv.13 真仙中期</option><option>Lv.13 真仙後期</option>
                    <option>Lv.14 金仙前期</option><option>Lv.14 金仙中期</option><option>Lv.14 金仙後期</option>
                    <option>Lv.15 上仙前期</option><option>Lv.15 上仙中期</option><option>Lv.15 上仙後期</option>
                    <option>Lv.16 仙君前期</option><option>Lv.16 仙君中期</option><option>Lv.16 仙君後期</option>
                    <option>Lv.17 仙尊前期</option><option>Lv.17 仙尊中期</option><option>Lv.17 仙尊後期</option>
                    <option>Lv.18 仙帝前期</option><option>Lv.18 仙帝中期</option><option>Lv.18 仙帝後期</option>
                    </select>
                    

                    <label><input type="number" id="currentExp"  placeholder="輸入您目前的修為值"></label><br>

                    <fieldset style="border:1px solid #ccc;padding:10px;">
                        <legend style="font-size:16px;">Step3 - 選擇您的心法等級</legend>
                        <select id="youxuangong"><option>幽玄宮Lv.0</option><option>幽玄宮Lv.1</option><option>幽玄宮Lv.2</option><option>幽玄宮Lv.3</option><option>幽玄宮Lv.4</option><option>幽玄宮Lv.5</option></select><br>
                        <select id="bingxinjue"><option>冰心訣Lv.0</option><option>冰心訣Lv.1</option><option>冰心訣Lv.2</option><option>冰心訣Lv.3</option><option>冰心訣Lv.4</option><option>冰心訣Lv.5</option></select><br>
                        <select id="xuanminggong"><option>玄冥功Lv.0</option><option>玄冥功Lv.1</option><option>玄冥功Lv.2</option><option>玄冥功Lv.3</option><option>玄冥功Lv.4</option><option>玄冥功Lv.5</option></select><br>
                        <select id="tianminglu"><option>天命錄Lv.0</option><option>天命錄Lv.1</option><option>天命錄Lv.2</option><option>天命錄Lv.3</option><option>天命錄Lv.4</option><option>天命錄Lv.5</option></select><br>
                        <br><span style="color:#f00; font-size:14px;">★若沒有該心法則不用選擇</span>
                    </fieldset><br>

                    <fieldset style="border:1px solid #ccc;padding:10px;">
                        <legend style="font-size:16px;">Step4 - 勾選您擁有的功法</legend>
                        <label style="font-size:16px;"><input type="checkbox" class="gongfa" value="5">Lv.4 帝辰殘篇</label><br>
                        <label style="font-size:16px;"><input type="checkbox" class="gongfa" value="5">Lv.5 英雄心法</label><br>
                        <label style="font-size:16px;"><input type="checkbox" class="gongfa" value="15">Lv.11 萬仙鎮世圖</label><br>
                        <label style="font-size:16px;"><input type="checkbox" class="gongfa" value="30">Lv.12 周天星海咒</label><br>
                        <label style="font-size:16px;"><input type="checkbox" class="gongfa" value="70">Lv.18 大道甚夷卷</label><br>
                    </fieldset><br>

                    <input type="number" id="battle" placeholder="輸入您目前的戰役值">
                    
                    <select id="friends">
                        <option value="">目前密友數量</option>
                        <option value="0">0位</option>
                        <option value="1">1位</option>
                        <option value="2">2位</option>
                        <option value="3">3位</option>
                    </select>
                    <select id="springBoost">
                        <option value="">有無泡靈泉or贏靈泉</option>
                        <option value="0">無</option>
                        <option value="0.1">泡靈泉</option>
                        <option value="0.4">贏靈泉</option>
                    </select><br><br>


                    <button onclick="predictStage()">開始預測</button>
                    <div id="predictionResult" style="margin-top:20px;font-weight:bold;font-size:14px;"></div>
                </div>
            </div>
        </div>
    </div>
    <script src="js/calculator.js?v=1.6.0"></script>
    <script>
        document.addEventListener("DOMContentLoaded", () => {
            const predictBtn = document.getElementById("floatingPredictBtn");
            const predictModal = document.getElementById("predictModal");
            const closePredict = document.querySelector(".closePredictModal");

            predictBtn.addEventListener("click", (e) => {
                e.preventDefault();
                predictModal.style.display = "block";
            });

            closePredict.addEventListener("click", () => {
                predictModal.style.display = "none";
            });

            window.addEventListener("click", (e) => {
                if (e.target === predictModal) {
                predictModal.style.display = "none";
                }
            });
        });

    </script>
    <script>
        //fetch('https://api.ipify.org?format=json')
        //    .then(response => response.json())
         //   .then(data => {
          //      if (data.ip === '185.213.82.117') {
          //          document.body.innerHTML = `
          //              <div style="text-align:center; padding:100px; font-family:Microsoft JhengHei;">
          //                  <h1 style="color:#b20000;">⚠️ 您已被封鎖</h1>
          //                  <p style="font-size:20px;">由於異常行為，您的 IP 已被限制訪問本網站。</p>
          //                  <p style="font-size:16px;">如有疑問請聯繫管理員。</p>
          //              </div>
           //         `;
           //         document.title = "訪問被拒絕";
           //     }
          //  })
          //  .catch(error => {
          //      console.error('取得 IP 發生錯誤', error);
          //  });
    </script>

    <script>
        const now = new Date();
        const hour = now.getHours();

        const infoText = document.getElementById("infoText");

        if (hour < 8) {
            infoText.textContent = "請確保資訊的更新時間，每天0時會清空";
        } else {
            infoText.textContent = "請確保資訊的更新時間，每天0時會清空";
        }
    </script>
    <script>
        const tabBtnsQ = document.querySelectorAll(".tab-btn-q");
        const tabContentsQ = document.querySelectorAll(".tab-content-q");
        tabBtnsQ.forEach(btn => {
            btn.addEventListener("click", () => {
                const target = btn.getAttribute("data-target");

                tabBtnsQ.forEach(b => b.classList.remove("active"));
                btn.classList.add("active");

                tabContentsQ.forEach(content => {
                    content.style.display = content.id === target ? "block" : "none";
                });
            });
        });
        window.addEventListener("DOMContentLoaded", () => {
            fetch("https://fanshopping.com.tw/wp/visit.php")
                .then(response => response.json())
                .then(data => {
                    if (data.totalVisits !== undefined) {
                        const formattedCount = Number(data.totalVisits).toLocaleString();
                        document.getElementById("visitCounter").innerText = "📈 本站總訪問次數：" + formattedCount;
                    } else {
                        document.getElementById("visitCounter").innerText = "載入瀏覽次數失敗";
                        console.error("API 回傳錯誤：", data);
                    }
                })
                .catch(error => {
                    document.getElementById("visitCounter").innerText = "連線錯誤";
                    console.error("發生錯誤：", error);
                });
                const versionKey = "updateNoticeShown_20250504";
                const modal = document.getElementById("updateNoticeModal");
                const closeBtn = document.querySelector(".update-close");
                const dismissForeverBtn = document.getElementById("dismissForeverBtn");
                if (!localStorage.getItem(versionKey)) {
                    modal.style.display = "block";
                }
                closeBtn.onclick = () => modal.style.display = "none";
                dismissForeverBtn.onclick = () => {
                    localStorage.setItem(versionKey, "true");
                    modal.style.display = "none";
                };
                window.onclick = (e) => {
                    if (e.target === modal) {
                        modal.style.display = "none";
                    }
                };

                const openBtn = document.getElementById("openRequestModal");
                const modalReq = document.getElementById("requestModal");
                const closeBtnReq = document.querySelector(".closeRequestModal");

                openBtn.onclick = () => modalReq.style.display = "block";
                closeBtnReq.onclick = () => modalReq.style.display = "none";
                window.onclick = (e) => {
                    if (e.target === modalReq) {
                        modalReq.style.display = "none";
                    }
                };

                document.getElementById("submitRequest").addEventListener("click", () => {
                    const level = document.getElementById("req-level").value;
                    const nickname = document.getElementById("req-nickname").value.trim();
                    const power = document.getElementById("req-power").value.trim();
                    const attr = document.getElementById("req-attr").value;
                    const location = document.getElementById("req-location").value.trim();
                    const note = document.getElementById("req-note").value.trim();

                    if (!level || !nickname || !power || !attr || !location) {
                        Swal.fire({
                            toast: true,
                            position: 'top',
                            icon: 'warning',
                            title: '請填寫完整資訊！',
                            showConfirmButton: false,
                            timer: 2000,
                            timerProgressBar: true,
                            customClass: {
                                popup: 'my-toast'
                            }
                        });
                        return;
                    }

                    fetch("https://fanshopping.com.tw/wp/save_request.php", {
                        method: "POST",
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ level, nickname, power, attr, location, note })
                    })
                    .then(res => res.json())
                    .then(data => {
                        if (data.success) {
                            Swal.fire({
                                toast: true,
                                position: 'top',
                                icon: 'success',
                                title: '送出成功！',
                                showConfirmButton: false,
                                timer: 2000,
                                timerProgressBar: true,
                                customClass: {
                                    popup: 'my-toast'
                                }
                            });

                            modalReq.style.display = "none";
                            updateVerticalMarquee();
                        } else {
                            Swal.fire({
                                toast: true,
                                position: 'top',
                                icon: 'error',
                                title: '送出失敗，請稍後再試',
                                showConfirmButton: false,
                                timer: 2500,
                                timerProgressBar: true,
                                customClass: {
                                    popup: 'my-toast'
                                }
                            });
                        }
                    })
                    .catch(() => {
                        Swal.fire({
                            toast: true,
                            position: 'top',
                            icon: 'error',
                            title: '伺服器錯誤，請稍後再試',
                            showConfirmButton: false,
                            timer: 2500,
                            timerProgressBar: true,
                            customClass: {
                                popup: 'my-toast'
                            }
                        });
                    });
                });
        });


        let currentSlideIndex = 0;
        let slideData = [];
        let rotationInterval = null;

        function timeAgo(createdTime) {
            const now = new Date();
            const created = new Date(createdTime);
            const diffMs = now - created;
            const diffSeconds = Math.floor(diffMs / 1000);

            if (diffSeconds < 60) {
                return `${diffSeconds}秒前`;
            }
            const diffMinutes = Math.floor(diffSeconds / 60);
            if (diffMinutes < 60) {
                return `${diffMinutes}分鐘前`;
            }
            const diffHours = Math.floor(diffMinutes / 60);
            if (diffHours < 24) {
                return `${diffHours}小時前`;
            }
            const diffDays = Math.floor(diffHours / 24);
            return `${diffDays}天前`;
        }

        function showSlide(index) {
            const container = document.getElementById("verticalCardDisplay");

            const oldCard = container.querySelector(".vertical-slide-card");
            if (oldCard) {
                oldCard.classList.remove("enter");
                oldCard.classList.add("exit");
                setTimeout(() => {
                    if (oldCard.parentNode) oldCard.parentNode.removeChild(oldCard);
                }, 600);
            }

            const d = slideData[index];
            const attrIconMap = {
                "水": "💧",
                "火": "🔥",
                "木": "🪵"
            };
            const attrIcon = attrIconMap[d.attr] || "";
            const timeText = d.created_at ? timeAgo(d.created_at) : "";

            const newCard = document.createElement("div");
            newCard.className = "vertical-slide-card enter";
            newCard.setAttribute("data-attr", d.attr);
            newCard.innerHTML = `
                <div style="display: flex; justify-content: space-between; align-items: center;">
                    <strong>Lv.${d.level}｜${d.nickname}｜${attrIcon}</strong>
                    <small style="color: gray; font-size: 12px;">${timeText}</small>
                </div>
                <div>
                    
                    戰力 ➠ ${Number(d.power).toLocaleString()}<br>
                    位置 ➠ ${d.location}${d.note ? "<br>備註 ➠ " + d.note : ""}
                </div>
            `;
            container.appendChild(newCard);
        }

        function showNoDataCard() {
            const container = document.getElementById("verticalCardDisplay");

            const oldCard = container.querySelector(".vertical-slide-card");
            if (oldCard) {
                oldCard.classList.remove("enter");
                oldCard.classList.add("exit");
                setTimeout(() => {
                    if (oldCard.parentNode) oldCard.parentNode.removeChild(oldCard);
                }, 600);
            }

            const newCard = document.createElement("div");
            newCard.className = "vertical-slide-card enter";
            newCard.innerHTML = `<strong style="color:#888;">尚無求打資訊</strong>`;
            container.appendChild(newCard);
        }

        function startCardRotation() {
            if (rotationInterval) {
                clearInterval(rotationInterval);
            }

            rotationInterval = setInterval(() => {
                if (slideData.length === 0) return;
                currentSlideIndex = (currentSlideIndex + 1) % slideData.length;
                showSlide(currentSlideIndex);
            }, 3000);
        }

        function updateVerticalMarquee() {
            fetch("https://fanshopping.com.tw/wp/get_requests.php")
                .then(res => res.json())
                .then(data => {
                    slideData = data;
                    currentSlideIndex = 0;

                    if (slideData.length > 0) {
                        showSlide(currentSlideIndex);
                        startCardRotation();
                    } else {
                        showNoDataCard();

                        if (rotationInterval) {
                            clearInterval(rotationInterval);
                        }
                    }
                });
        }

        window.addEventListener("DOMContentLoaded", () => {
            updateVerticalMarquee();
        });

    </script>
    <script>
        const openAllBtn = document.getElementById("openAllRequestsModal");
        const allModal = document.getElementById("allRequestsModal");
        const closeAllBtn = document.querySelector(".closeAllRequestsModal");

        openAllBtn.onclick = () => {
        allModal.style.display = "block";
        fetch("https://fanshopping.com.tw/wp/get_requests.php")
            .then(res => res.json())
            .then(data => {
                const list = document.getElementById("allRequestsList");
                list.innerHTML = "";
                document.getElementById("noResultMessage")?.remove();

                if (data.length > 0) {
                    data.forEach(d => {
                        const attrIcons = {
                            "水": "💧",
                            "火": "🔥",
                            "木": "🪵"
                        };
                        const icon = attrIcons[d.attr] || "";
                        const timeText = d.created_at ? timeAgo(d.created_at) : "";

                        const card = document.createElement("div");
                        card.className = "carousel-card";
                        card.setAttribute("data-attr", d.attr);
                        card.setAttribute("data-level", d.level);

                        card.innerHTML = `
                            <div style="display: flex; justify-content: space-between; align-items: center;">
                                <strong>Lv.${d.level}｜${d.nickname}｜${icon}</strong>
                                <small style="color: gray; font-size: 12px;">${timeText}</small>
                            </div>
                            <div>
                                戰力 ➠ ${Number(d.power).toLocaleString()}<br>
                                位置 ➠ ${d.location}${d.note ? "<br>備註 ➠ " + d.note : ""}
                            </div>
                        `;
                        list.appendChild(card);
                    });
                } else {
                    list.innerHTML = `<p id="noResultMessage">目前尚無求打資訊</p>`;
                }
            });
        };

        closeAllBtn.onclick = () => {
        allModal.style.display = "none";
        };

        window.onclick = (e) => {
        if (e.target === allModal) {
            allModal.style.display = "none";
        }
        };
        document.getElementById("searchLevel").addEventListener("change", function () {
            const selectedLevel = this.value;
            const cards = document.querySelectorAll("#allRequestsList .carousel-card");

            let hasVisible = false;

            cards.forEach(card => {
                const cardLevel = card.getAttribute("data-level");
                if (!selectedLevel || cardLevel === selectedLevel) {
                card.style.display = "block";
                hasVisible = true;
                } else {
                card.style.display = "none";
                }
            });

            const noResult = document.getElementById("noResultMessage");
            if (!hasVisible) {
                if (!noResult) {
                const msg = document.createElement("div");
                msg.id = "noResultMessage";
                msg.textContent = "目前尚無求打資訊...";
                msg.style.cssText = "text-align:center; padding:20px; font-weight:bold; color:#666;";
                document.getElementById("allRequestsList").appendChild(msg);
                }
            } else {
                if (noResult) noResult.remove();
            }
            });


    </script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

</body>
</html>
